{"version":3,"file":"public_js_editEntry_js.bundle.js","mappings":";;;;;;;;;;;;;;;;;;;AAAkC;AACqC;AAC5B;AACZ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,gBAAgB,qDAAY;AAC5B,6BAA6B,qDAAY;AACzC,WAAW,qDAAY;AACvB;AACA;AACA;AACA,QAAQ,+CAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,cAAc;AACd;AACA;AACA,yBAAyB,qEAAkB;AAC3C;AACA;AACA;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA,gCAAgC,yBAAyB;AACzD,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA,gCAAgC,8BAA8B;AAC9D,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA,gBAAgB,CAAC;AACjB;AACA,gBAAgB,CAAC;AACjB;AACA,gCAAgC,0BAA0B;AAC1D;AACA,oBAAoB,CAAC;AACrB;AACA;AACA,gBAAgB,CAAC;AACjB;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA;AACA,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA;AACA,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA;AACA,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB,kBAAkB;AAClB,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA,gBAAgB,CAAC;AACjB;AACA;AACA,gBAAgB,CAAC;AACjB;AACA,gBAAgB,CAAC;AACjB;AACA;AACA,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB,oBAAoB,CAAC;AACrB;AACA;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA;AACA;AACA,oBAAoB,CAAC;AACrB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,aAAa,EAAE;AACf;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,CAAC;AACL;AACA,KAAK;AACL,IAAI,CAAC;AACL,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,KAAK;AACL,IAAI,CAAC;AACL,QAAQ,CAAC;AACT;AACA,KAAK;AACL;AACA;AACA,QAAQ,CAAC;AACT;AACA,YAAY,CAAC;AACb,SAAS;AACT;AACA;AACA;AACA,IAAI,CAAC;AACL,YAAY,CAAC;AACb,YAAY,CAAC;AACb;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI,CAAC;AACL;AACA;AACA,KAAK;AACL;AACA,IAAI,CAAC;AACL;AACA,yBAAyB,CAAC;AAC1B,4BAA4B,mBAAmB;AAC/C;AACA,UAAU;AACV,yBAAyB,CAAC;AAC1B,4BAA4B,mBAAmB;AAC/C;AACA;AACA,KAAK;AACL;AACA,IAAI,CAAC;AACL;AACA,YAAY,CAAC;AACb,YAAY,CAAC;AACb,UAAU;AACV,YAAY,CAAC;AACb,YAAY,CAAC;AACb;AACA,KAAK;AACL;AACA,IAAI,CAAC;AACL;AACA,YAAY,CAAC;AACb,YAAY,CAAC;AACb,YAAY,CAAC;AACb,YAAY,CAAC;AACb,UAAU;AACV,YAAY,CAAC;AACb,YAAY,CAAC;AACb,YAAY,CAAC;AACb,YAAY,CAAC;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAI,CAAC;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,yBAAyB;AACjD;AACA;AACA;AACA,YAAY,CAAC;AACb,YAAY,CAAC;AACb;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb,UAAU;AACV,YAAY,CAAC;AACb;AACA,MAAM;AACN;AACA;AACA;AACA,gBAAgB,CAAC;AACjB,cAAc;AACd,gBAAgB,CAAC;AACjB;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT;AACA,MAAM;AACN;AACA,YAAY,CAAC;AACb;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,gCAAgC;AACxD;AACA,YAAY,CAAC;AACb;AACA,MAAM;AACN;AACA;AACA,4BAA4B,oCAAoC;AAChE;AACA,gBAAgB,CAAC;AACjB;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN;AACA;AACA,YAAY,CAAC;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN,QAAQ,CAAC,sBAAsB,0DAAiB;AAChD;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN,QAAQ,CAAC,sBAAsB,0DAAiB;AAChD;AACA;AACA;AACA;AACA,wBAAwB,kCAAkC;AAC1D;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb;AACA,MAAM;AACN;AACA;AACA,4BAA4B,sCAAsC;AAClE;AACA;AACA;AACA;AACA,gBAAgB,CAAC;AACjB;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb,YAAY,CAAC;AACb,YAAY,CAAC;AACb;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,gBAAgB,CAAC;AACjB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB,gBAAgB,CAAC;AACjB;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN;AACA,YAAY,CAAC;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2CAA2C;AACnE;AACA;AACA;AACA;AACA;AACA,QAAQ,CAAC;AACT,MAAM;AACN;AACA;AACA,4BAA4B,2CAA2C;AACvE;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,IAAI,CAAC;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+BAA+B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAA6B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,2BAA2B,CAAC;AAC5B,IAAI,CAAC;AACL;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb;AACA;AACA,UAAU;AACV;AACA,4BAA4B,CAAC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ,CAAC;AACT,gCAAgC,CAAC;AACjC;AACA;AACA;AACA;AACA,0BAA0B,mEAAgB;AAC1C;AACA;AACA;AACA,gBAAgB;AAChB,MAAM;AACN;AACA,gBAAgB;AAChB,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,CAAC;AACb;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,yBAAyB,CAAC;AAC1B,+BAA+B,CAAC;AAChC,gCAAgC,CAAC;AACjC,0BAA0B,CAAC;AAC3B,wBAAwB,CAAC;AACzB;AACA;AACA,wBAAwB,aAAa;AACrC,gBAAgB,CAAC;AACjB,oBAAoB,CAAC;AACrB,uCAAuC,CAAC;AACxC,kBAAkB;AAClB;AACA;AACA,cAAc;AACd;AACA;AACA;A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AA4B,CAAC;AAC7B,6BAA6B,CAAC;AAC9B,sBAAsB,CAAC;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,wBAAwB,mDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,6BAA6B,iDAAiD;AAC9E;AACA,+BAA+B,iDAAiD;AAChF;AACA;AACA;AACA;AACA,oCAAoC,2DAA2D;AAC/F;AACA;AACA,oCAAoC,2DAA2D;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,uDAAiB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT,YAAY,CAAC;AACb;AACA;AACA,YAAY,CAAC;AACb,YAAY,+CAAQ;AACpB,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,IAAI,CAAC;AACL;AACA;AACA;AACA;AACA;AACA,IAAI,CAAC;AACL,IAAI,CAAC;AACL,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,MAAM;AACN,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT,QAAQ,CAAC;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,wBAAwB;AAC5C;AACA;AACA,6DAA6D,GAAG;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA","sources":["webpack://sc-library/./public/js/editEntry.js"],"sourcesContent":["import { goToPage } from \"./ajax\";\r\nimport { findURLValue, switchISBNformats, verifyISBN } from \"./common\";\r\nimport firebase from 'firebase/compat/app';\r\nimport { db } from \"./globals\";\r\n\r\n/* Implement the whole thing in a transaction to ensure that nothing breaks along the way.\r\ndb.runTransaction((transaction) => {\r\n    // This code may run multiple times if there are confilcts\r\n    var bookPath = db.collection(\"books\").doc(barcodeNumber);\r\n    return transaction.get(bookPath).then((doc) => {\r\n        if (!doc.exists) {\r\n            throw \"Document does not exist!\";\r\n        }\r\n    });\r\n}).then((content) => {\r\n    // Will run after transaction success.\r\n}).catch((error) => {\r\n    // Will run after transaction failure.\r\n});\r\n*/\r\nvar editEntryData = null;\r\nvar newEntry = null;\r\nvar barcodeNumber;\r\nvar isbn;\r\n\r\nexport function setupEditEntry(pageQuery) {\r\n    editEntryData = null;\r\n    file = null;\r\n    newEntry = null;\r\n    newEntry = (findURLValue(pageQuery, \"new\") == \"true\");\r\n    barcodeNumber = parseInt(findURLValue(pageQuery, \"id\", true));\r\n    isbn = findURLValue(pageQuery, \"isbn\", true);\r\n    \r\n    if (barcodeNumber == \"\" && newEntry == false) {\r\n        alert(\"The barcode that you are trying to edit is not valid.\");\r\n        goToPage(\"admin/main\");\r\n        return;\r\n    }\r\n\r\n    if (!newEntry) {\r\n        // If this is not a new entry, just get the content that exists in the database\r\n        if (!isNaN(barcodeNumber)) {\r\n            var document = Math.floor(barcodeNumber / 100) % 100;\r\n            if (document >= 100) {\r\n                document = \"\" + document;\r\n            } else if (document >= 10) {\r\n                document = \"0\" + document;\r\n            } else {\r\n                document = \"00\" + document;\r\n            }\r\n            var docRef = firebase.firestore().collection(\"books\").doc(document);\r\n            docRef.get().then((doc) => {\r\n                var data = doc.data().books[barcodeNumber % 100];\r\n                editEntryData = data;\r\n                $('#barcode').html(barcodeNumber);\r\n                $(\"#book-title\").val(data.title);\r\n                $(\"#book-subtitle\").val(data.subtitle);\r\n\r\n                for (let i = 0; i < data.authors.length; i++) {\r\n                    $(\"#book-author-\" + (i + 1) + \"-last\").val(data.authors[i].last);\r\n                    $(\"#book-author-\" + (i + 1) + \"-first\").val(data.authors[i].first);\r\n                }\r\n\r\n                for (let i = 0; i < data.illustrators.length; i++) {\r\n                    $(\"#book-illustrator-\" + (i + 1) + \"-last\").val(data.illustrators[i].last);\r\n                    $(\"#book-illustrator-\" + (i + 1) + \"-first\").val(data.illustrators[i].first);\r\n                }\r\n\r\n                $(\"#book-medium\").val(data.medium);\r\n\r\n                $(\"#book-cover-image\").attr('src', data.coverImageLink);\r\n\r\n                for (let i = 0; i < data.subjects.length; i++) {\r\n                    addSubject();\r\n                    $(\"#book-subject-\" + (i + 1)).val(data.subjects[i]);\r\n                }\r\n\r\n                $(\"#book-description\").val(data.description);\r\n\r\n                $(\"#book-audience-children\").prop(\"checked\", data.audience[0]);\r\n                $(\"#book-audience-youth\").prop(\"checked\", data.audience[1]);\r\n                $(\"#book-audience-adult\").prop(\"checked\", data.audience[2]);\r\n                $(\"#book-audience-none\").prop(\"checked\", data.audience[3]);\r\n                \r\n                $(\"#book-isbn-10\").val(data.isbn10);\r\n                $(\"#book-isbn-13\").val(data.isbn13);\r\n\r\n                if (data.isbn10 == \"\" && data.isbn13 == \"\") {\r\n                    $(\"#book-no-isbn\").prop(\"checked\", true);\r\n                    $(\"#book-isbn-10\")[0].disabled = true;\r\n                    $(\"#book-isbn-13\")[0].disabled = true;\r\n                }\r\n\r\n                $(\"#book-publisher-1\").val(data.publishers[0]);\r\n                $(\"#book-publisher-2\").val(data.publishers[1]);\r\n\r\n                if (data.publishDate != null) {\r\n                    $(\"#book-publish-month\").val(data.publishDate.toDate().getMonth() + 1);\r\n                    $(\"#book-publish-day\").val(data.publishDate.toDate().getDate());\r\n                    $(\"#book-publish-year\").val(data.publishDate.toDate().getFullYear());\r\n                }\r\n\r\n                if (data.numberOfPages != -1) {\r\n                    $(\"#book-pages\").val(data.numberOfPages);\r\n                    $(\"#book-unnumbered\").prop(\"checked\", false);\r\n                } else if (data.numberOfPages == -1) {\r\n                    $(\"#book-pages\")[0].disabled = true;\r\n                    $(\"#book-unnumbered\").prop(\"checked\", true);\r\n                }\r\n\r\n                $(\"#book-dewey\").val(data.ddc);\r\n\r\n                let temp = (data.canBeCheckedOut) ? \"y\":\"\";\r\n                $(\"#book-can-be-checked-out\").val(temp);\r\n                temp = (data.isHidden) ? \"y\":\"\";\r\n                $(\"#book-is-hidden\").val(temp);\r\n\r\n                if (data.purchaseDate != null) {\r\n                    $(\"#book-purchase-month\").val(data.purchaseDate.toDate().getMonth() + 1);\r\n                    $(\"#book-purchase-day\").val(data.purchaseDate.toDate().getDate());\r\n                    $(\"#book-purchase-year\").val(data.purchaseDate.toDate().getFullYear());\r\n                }\r\n\r\n                $(\"#book-purchase-price\").val(data.purchasePrice);\r\n                $(\"#book-vendor\").val(data.vendor);\r\n\r\n                if (data.lastUpdated != null) {\r\n                    var lastUpdated = data.lastUpdated.toDate();\r\n                    $(\"#last-updated\").html(\"This entry was last updated on \" + lastUpdated.toLocaleDateString('en-US') + \" at \" + lastUpdated.toLocaleTimeString('en-US'));\r\n                }\r\n            });\r\n\r\n            /* This should all be obsolete now\r\n            var coverImageLink;\r\n            firebase.storage().ref().child(\"books\").child(\"\" + barcodeNumber).listAll().then((result) => {\r\n                result.items.forEach((itemRef) => {\r\n                    // If we store more that just one image per book, this will probably break.\r\n                    coverImageLink = itemRef.getDownloadURL();\r\n                    $(\"#book-cover-image\").attr('src', coverImageLink);\r\n                });\r\n            }).catch((error) => {\r\n                console.error(error);\r\n            });*/\r\n        }\r\n        \r\n    } else {\r\n        // If this is a new entry (and they are creating it for the first time) go get info from open library\r\n        if (isbn.length >= 10) {\r\n            gatherExternalInformation(isbn).then((noISBN = false, bookObject, authorObject, worksObject) => {\r\n                // If this is a brand new entry...\r\n                loadDataOnToEditEntryPage(noISBN, bookObject, authorObject, worksObject);\r\n            }).catch(() => {\r\n                // The ISBN Number is valid, but there is not a listing in Open Library\r\n                alert(\"The ISBN number that you entered (\" + isbn + \") is a valid number, but we did not find a listing for it in the external database. You will need to create an entry manually.\");\r\n            });\r\n        } else {\r\n            loadDataOnToEditEntryPage(true);\r\n        }\r\n    }\r\n\r\n    // Create Event Listeners to handle book cover image changes\r\n    // All are required to handle leaving the element and coming back again\r\n    $(\"#book-cover-image\").on(\"mouseover\", () => {\r\n        showAccountImageOverlay();\r\n    });\r\n    $(\"#book-cover-image-overlay\").on(\"mouseleave\", () => {\r\n        $(\"#book-cover-image-overlay\").css(\"opacity\", \"0\");\r\n        $(\"#book-cover-image-overlay\").delay(300).hide(0);\r\n    });\r\n    $(\"#book-cover-image-overlay\").on(\"mouseover\", () => {\r\n        $(\"#book-cover-image-overlay\").clearQueue().stop();\r\n        showAccountImageOverlay();\r\n    });\r\n\r\n    function showAccountImageOverlay() {\r\n        $(\"#book-cover-image-overlay\").show();\r\n        setTimeout(() => {\r\n            $(\"#book-cover-image-overlay\").css(\"opacity\", \"1\");\r\n        }, 5);\r\n    }\r\n\r\n    // If a user clicks the button to change the book cover image, click the input button\r\n    $(\"#book-cover-image-overlay\").on(\"click\", () => {\r\n        if ($(\"#file-input\")) {\r\n            $(\"#file-input\").trigger(\"click\");\r\n        }\r\n    });\r\n\r\n    // If the user attempts to leave, let them know if they have unsaved changes\r\n    // TO DO: Remove when the user leaves the page.\r\n    $(window).on(\"beforeunload\", function (event) {\r\n        event.preventDefault();\r\n        return \"If you leave the page now, your changes will not be saved. If this is a new entry, you will be left with a blank entry\";\r\n    });\r\n\r\n    $(\"#book-medium\")[0].addEventListener(\"input\", (event) => {\r\n        if (event.target.value == \"av\") {\r\n            let goAway = $(\".no-av\");\r\n            for (let i = 0; i < goAway.length; i++)\r\n                goAway[i].style.display = \"none\";\r\n        } else {\r\n            let goAway = $(\".no-av\");\r\n            for (let i = 0; i < goAway.length; i++)\r\n                goAway[i].style.display = \"\";\r\n        }\r\n    });\r\n    \r\n    $(\"#book-unnumbered\")[0].addEventListener(\"input\", (event) => {\r\n        if (event.target.checked == true) {\r\n            $(\"#book-pages\").val(\"\");\r\n            $(\"#book-pages\")[0].disabled = true;\r\n        } else {\r\n            $(\"#book-pages\").val(\"\");\r\n            $(\"#book-pages\")[0].disabled = false;\r\n        }\r\n    });\r\n    \r\n    $(\"#book-no-isbn\")[0].addEventListener(\"input\", (event) => {\r\n        if (event.target.checked == true) {\r\n            $(\"#book-isbn-10\").val(\"\");\r\n            $(\"#book-isbn-10\")[0].disabled = true;\r\n            $(\"#book-isbn-13\").val(\"\");\r\n            $(\"#book-isbn-13\")[0].disabled = true;\r\n        } else {\r\n            $(\"#book-isbn-10\").val(\"\");\r\n            $(\"#book-isbn-10\")[0].disabled = false;\r\n            $(\"#book-isbn-13\").val(\"\");\r\n            $(\"#book-isbn-13\")[0].disabled = false;\r\n        }\r\n    });\r\n\r\n    \r\n}\r\n\r\nfunction loadDataOnToEditEntryPage(noISBN, bookObject, authorObject, worksObject) {\r\n    $('#barcode').html(barcodeNumber);\r\n    if (noISBN) {\r\n        return;\r\n    }\r\n    \r\n    // Title\r\n    try {\r\n        $('#book-title').val(bookObject.title);\r\n    } catch {\r\n        console.error(\"The book doesn't have a title????? Something is wrong.\");\r\n        console.log(bookObject);\r\n    }\r\n\r\n    // Subtitle\r\n    try {\r\n        $('#book-subtitle').val(bookObject.subtitle);\r\n    } catch {\r\n        console.log(\"No subtitle found\");\r\n        console.log(bookObject);\r\n    }\r\n\r\n    // Author\r\n    try {\r\n        for (let i = 0; i < authorObject.length; i++) {\r\n            var fullName = authorObject[i].name;\r\n            var lastName = fullName.substring(fullName.lastIndexOf(' ') + 1, fullName.length);\r\n            var firstName  = fullName.substring(0, fullName.lastIndexOf(' '));\r\n            $('#book-author-' + (i + 1) + '-last').val(lastName);\r\n            $('#book-author-' + (i + 1) + '-first').val(firstName);\r\n        }\r\n    } catch {\r\n        console.error(\"The book doesn't have an author?\");\r\n        console.log(bookObject);\r\n        console.log(authorObject);\r\n    }\r\n\r\n    // Medium - Only looks at the first work (if there are multiple)\r\n    try {\r\n        if (bookObject.physical_format == \"paperback\") {\r\n            $(\"book-medium\").val(\"Paperback\");\r\n        } else if (bookObject.physical_format == \"hardcover\") {\r\n            $(\"book-medium\").val(\"Hardcover\");\r\n        }\r\n    } catch {\r\n        console.log(\"The book object did not have a medium. Falling back to the works object.\");\r\n        try {\r\n            if (worksObject[0].physical_format == \"paperback\") {\r\n                $(\"book-medium\").val(\"Paperback\");\r\n            } else if (worksObject[0].physical_format == \"hardcover\") {\r\n                $(\"book-medium\").val(\"Hardcover\");\r\n            }\r\n        } catch {\r\n            console.warn(\"Neither source had a medium for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Cover\r\n    // THIS DOES NOT STORE IT IN STORAGE - That happens when they click save\r\n    // TODO: Make the above statement true. The commented out lines below probably need to be moved to the save button.\r\n    // Also at the save button, the image link should be stored in the database\r\n    try {\r\n        $('#book-cover-image').attr('src', \"https://covers.openlibrary.org/b/id/\" + bookObject.covers[0] + \"-L.jpg\");\r\n        // uploadCoverImageFromExternal(\"https://covers.openlibrary.org/b/id/\" + bookObject.covers[0] + \"-L.jpg\");\r\n    } catch {\r\n        try {\r\n            $('#book-cover-image').attr('src', \"https://covers.openlibrary.org/b/id/\" + worksObject[0].covers[0] + \"-L.jpg\");\r\n            //uploadCoverImageFromExternal(\"https://covers.openlibrary.org/b/id/\" + worksObject[0].covers[0] + \"-L.jpg\");\r\n        } catch {\r\n            console.warn(\"A cover could not be found for either the book or the work\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Subject\r\n    try {\r\n        for (let i = 0; i < bookObject.subjects.length; i++) {\r\n            addSubject();\r\n            $('#book-subject-' + (i + 1)).val(bookObject.subjects[i]);\r\n        }\r\n    } catch {\r\n        console.log(\"The books object did not have any subjects. Falling back to the works object\");\r\n        try {\r\n            for (let i = 0; i < worksObject[0].subjects.length; i++) {\r\n                addSubject();\r\n                $('#book-subject-' + (i + 1)).val(worksObject[0].subjects[i]);\r\n            }\r\n        } catch {\r\n            console.warn(\"Neither source had subjects for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Description - Only gets the description from the first work (if there are multiple)\r\n    try {\r\n        $(\"book-description\").val(worksObject[0].description.value);\r\n    } catch {\r\n        console.log(\"The works object did not have a description. Falling back to the book object.\");\r\n        try {\r\n            $(\"book-description\").val(bookObject.description.value);\r\n        } catch {\r\n            console.warn(\"Neither source had a description for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Audience???? I have yet to see this in an open library object, so I'm not including it\r\n\r\n    // ISBN 10 Number\r\n    if (isbn.length == 10) {\r\n        $(\"#book-isbn-10\").val(isbn);\r\n    } else {\r\n        $(\"#book-isbn-10\").val(switchISBNformats(isbn));\r\n    }\r\n\r\n    // ISBN 13 Number\r\n    if (isbn.length == 13) {\r\n        $(\"#book-isbn-13\").val(isbn);\r\n    } else {\r\n        $(\"#book-isbn-13\").val(switchISBNformats(isbn));\r\n    }\r\n\r\n    // Publisher\r\n    try {\r\n        for (let i = 0; i < bookObject.publishers.length; i++) {\r\n            if (i > 1) {\r\n                console.warn(\"A publisher was cut off because there was only two input boxes.\");\r\n                return;\r\n            }\r\n            $('#book-publisher-' + (i + 1)).val(bookObject.publishers[i]);\r\n        }\r\n    } catch {\r\n        console.log(\"The books object did not have any publishers. Falling back to the works object\");\r\n        try {\r\n            for (let i = 0; i < worksObject[0].publishers.length; i++) {\r\n                if (i > 1) {\r\n                    console.warn(\"A publisher was cut off because there was only two input boxes.\");\r\n                    return;\r\n                }\r\n                $('#book-publisher-' + (i + 1)).val(worksObject[0].publishers[i]);\r\n            }\r\n        } catch {\r\n            console.warn(\"Neither source had publishers for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Publish Date:\r\n    try {\r\n        let publish_date = bookObject.publish_date;\r\n        if (publish_date.length == 4) {\r\n            // We can assume that this is only a year.\r\n            $(\"#book-publish-year\").val(publish_date);\r\n        } else {\r\n            let month = publish_date.substring(0, publish_date.indexOf(\" \"));\r\n            let day = publish_date.substring(publish_date.indexOf(\" \") + 1, publish_date.indexOf(\",\"));\r\n            let year = publish_date.substring(publish_date.indexOf(\",\") + 2, publish_date.length);\r\n            switch (month) {\r\n                case \"Jan\":\r\n                case \"January\":\r\n                    month = 1;\r\n                    break;\r\n                case \"Feb\":\r\n                case \"February\":\r\n                    month = 2;\r\n                    break;\r\n                case \"Mar\":\r\n                case \"March\":\r\n                    month = 3;\r\n                    break;\r\n                case \"Apr\":\r\n                case \"April\":\r\n                    month = 4;\r\n                    break;\r\n                case \"May\":\r\n                    month = 5;\r\n                    break;\r\n                case \"Jun\":\r\n                case \"June\":\r\n                    month = 6;\r\n                    break;\r\n                case \"Jul\":\r\n                case \"July\":\r\n                    month = 7;\r\n                    break;\r\n                case \"Aug\":\r\n                case \"August\":\r\n                    month = 8;\r\n                    break;\r\n                case \"Sep\":\r\n                case \"September\":\r\n                    month = 9;\r\n                    break;\r\n                case \"Oct\":\r\n                case \"October\":\r\n                    month = 10;\r\n                    break;\r\n                case \"Nov\":\r\n                case \"November\":\r\n                    month = 11;\r\n                    break;\r\n                case \"Dec\":\r\n                case \"December\":\r\n                    month = 12;\r\n                    break;\r\n            \r\n                default:\r\n                    console.error(\"The month could not be detected\");\r\n                    month = -1;\r\n                    break;\r\n            }\r\n            $(\"#book-publish-year\").val(year);\r\n            $(\"#book-publish-month\").val(month);\r\n            $(\"#book-publish-day\").val(day);\r\n        }\r\n    } catch {\r\n        let publish_date = worksObject[0].publish_date;\r\n        try {\r\n            if (publish_date.length == 4) {\r\n                // We can assume that this is only a year.\r\n                $(\"#book-publish-year\").val(publish_date);\r\n            } else {\r\n                let month = publish_date.substring(0, publish_date.indexOf(\" \"));\r\n                let day = publish_date.substring(publish_date.indexOf(\" \") + 1, publish_date.indexOf(\",\"));\r\n                let year = publish_date.substring(publish_date.indexOf(\",\") + 2, publish_date.length);\r\n                switch (month) {\r\n                    case \"Jan\":\r\n                        month = 1;\r\n                        break;\r\n                    case \"Feb\":\r\n                        month = 2;\r\n                        break;\r\n                    case \"Mar\":\r\n                        month = 3;\r\n                        break;\r\n                    case \"Apr\":\r\n                        month = 4;\r\n                        break;\r\n                    case \"May\":\r\n                        month = 5;\r\n                        break;\r\n                    case \"Jun\":\r\n                        month = 6;\r\n                        break;\r\n                    case \"Jul\":\r\n                        month = 7;\r\n                        break;\r\n                    case \"Aug\":\r\n                        month = 8;\r\n                        break;\r\n                    case \"Sep\":\r\n                        month = 9;\r\n                        break;\r\n                    case \"Oct\":\r\n                        month = 10;\r\n                        break;\r\n                    case \"Nov\":\r\n                        month = 11;\r\n                        break;\r\n                    case \"Dec\":\r\n                        month = 12;\r\n                        break;\r\n                \r\n                    default:\r\n                        console.error(\"The month could not be detected\");\r\n                        month = -1;\r\n                        break;\r\n                }\r\n                $(\"#book-publish-year\").val(year);\r\n                $(\"#book-publish-month\").val(month);\r\n                $(\"#book-publish-day\").val(day);\r\n            }\r\n        } catch {\r\n            console.warn(\"Neither source had publish dates for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Number of Pages\r\n    try {\r\n        $(\"#book-pages\").val(bookObject.number_of_pages);\r\n    } catch {\r\n        try {\r\n            $(\"#book-pages\").val(worksObject[0].number_of_pages);\r\n        } catch {\r\n            console.warn(\"Neither source had a number of pages for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n\r\n    // Dewey Decimal Class\r\n    // I don't see why there would be two, but in case there are, they will get put in the same input\r\n    try {\r\n        let ddcAnswer = \"\";\r\n        for (let i = 0; i < bookObject.dewey_decimal_class.length; i++) {\r\n            if (i > 0) {\r\n                ddcAnswer += \", \";\r\n            }\r\n            ddcAnswer += bookObject.dewey_decimal_class[i];\r\n        }\r\n        $(\"#book-dewey\").val(ddcAnswer);\r\n    } catch {\r\n        try {\r\n            let ddcAnswer;\r\n            for (let i = 0; i < bookObject.dewey_decimal_class.length; i++) {\r\n                if (i > 0) {\r\n                    ddcAnswer += \" \";\r\n                }\r\n                ddcAnswer += bookObject.dewey_decimal_class[i];\r\n            }\r\n            $(\"#book-dewey\").val(ddcAnswer);\r\n        } catch {\r\n            console.warn(\"Neither source had a DDC for this book.\");\r\n            console.log(bookObject);\r\n            console.log(worksObject);\r\n        }\r\n    }\r\n    $(\"#last-updated\").hide();\r\n}\r\n\r\nfunction gatherExternalInformation(isbn) {\r\n    return (new Promise(function(resolve) {\r\n        if (isbn == \"\") {\r\n            // In this case, the entry was created without an isbn\r\n            resolve(true);\r\n        }\r\n        lookupBook(isbn)\r\n        .then((bookObject) => {\r\n            lookupAuthor(bookObject)\r\n            .then((authorObject) => {\r\n                lookupWorks(bookObject, authorObject)\r\n                .then((bookObject, authorObject, worksObject) => {\r\n                    resolve(false, bookObject, authorObject, worksObject);\r\n                }).catch((error) => {\r\n                    alert(\"There was an issue loading the works object info from the external database. Please ensure you input the isbn number correctly.\");\r\n                    console.error(error);\r\n                    resolve(true);\r\n                    return;\r\n                });\r\n            }).catch((error) => {\r\n                alert(\"There was an issue loading the author object from the external database. Please ensure you input the isbn number correctly.\");\r\n                console.error(error);\r\n                resolve(true);\r\n                return;\r\n            });\r\n        }).catch((error) => {\r\n            alert(\"There was an issue loading the book object info from the external database. Please ensure you input the isbn number correctly.\");\r\n            console.error(error);\r\n            resolve(true);\r\n            return;\r\n        });\r\n    }));\r\n}\r\n\r\n\r\nfunction lookupBook(isbn) {\r\n    return new Promise(function (resolve, reject) {\r\n        let xhttp = new XMLHttpRequest();\r\n\r\n        xhttp.open(\"GET\", \"https://openlibrary.org/isbn/\" + isbn + \".json\");\r\n        xhttp.send();\r\n        xhttp.onreadystatechange = function () {\r\n            if (this.status == 404 || this.status == 403 || this.status == 400) {\r\n                reject();\r\n            }\r\n            if (this.readyState == 4 && this.status == 200) {\r\n                resolve(JSON.parse(xhttp.responseText));\r\n            }\r\n        };\r\n    });\r\n}\r\n\r\nfunction lookupAuthor(bookObject) {\r\n    console.log(bookObject);\r\n    return new Promise(function (resolve, reject) {\r\n        var total = 0;\r\n        if (bookObject.authors) {\r\n            for (let i = 0; i < bookObject.authors.length; i++) {\r\n                let xhttp = new XMLHttpRequest();\r\n                var authorLink = bookObject.authors[i].key;\r\n\r\n                xhttp.open(\"GET\", \"https://openlibrary.org\" + authorLink + \".json\");\r\n                xhttp.send();\r\n                total++;\r\n                xhttp.onreadystatechange = function () {\r\n                    if (this.status == 404 || this.status == 403 || this.status == 400) {\r\n                        reject();\r\n                    }\r\n                    if (this.readyState == 4 && this.status == 200) {\r\n                        var authorObject = [];\r\n                        authorObject[i] = JSON.parse(xhttp.responseText);\r\n                        if (i == total - 1) {\r\n                            resolve(authorObject);\r\n                        }\r\n                    }\r\n                };\r\n            }\r\n        } else {\r\n            resolve(true);\r\n        }\r\n    });\r\n}\r\n\r\nfunction lookupWorks(bookObject) {\r\n    return new Promise(function (resolve, reject) {\r\n        var total = 0;\r\n        for (let i = 0; i < bookObject.works.length; i++) {\r\n            let xhttp = new XMLHttpRequest();\r\n            var worksLink = bookObject.works[i].key;\r\n\r\n            xhttp.open(\"GET\", \"https://openlibrary.org\" + worksLink + \".json\");\r\n            xhttp.send();\r\n            total++;\r\n            xhttp.onreadystatechange = function () {\r\n                if (this.status == 404 || this.status == 403 || this.status == 400) {\r\n                    reject();\r\n                }\r\n                if (this.readyState == 4 && this.status == 200) {\r\n                    var worksObject = [];\r\n                    worksObject[i] = JSON.parse(xhttp.responseText);\r\n                    if (i == total - 1) {\r\n                        resolve(worksObject);\r\n                    }\r\n                }\r\n            };\r\n        }\r\n    });\r\n}\r\n\r\nfunction addSubject() {\r\n    var numberofSubjects = $(\".subject-field\").length;\r\n    $(\"#book-subject-\" + numberofSubjects).after(\"<input id=\\\"book-subject-\" + (numberofSubjects + 1) + \"\\\" placeholder=\\\"\\\" class=\\\"normal-form-input subject-field\\\">\");\r\n}\r\n\r\nfunction saveImage() {\r\n    return new Promise(function (resolve) {\r\n        if ($(\"#book-medium\")[0].value == \"av\") resolve(true);\r\n        if (file) {\r\n            resolve(storeImage(file));\r\n        } else {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open('GET', $(\"#book-cover-image\").attr(\"src\"), true);\r\n            xhr.responseType = 'blob';\r\n            xhr.onload = function() {\r\n                if (this.status == 200) {\r\n                    if (this.responseURL.substring(0, 5) != \"https\") {\r\n                        alert(\"This image was not able to be saved securely. Please download it and try again.\");\r\n                        resolve(false);\r\n                    }\r\n                    file = this.response;\r\n                    resolve(storeImage(file));\r\n                }\r\n            };\r\n            xhr.send();\r\n        }\r\n    });\r\n}\r\n\r\nfunction storeImage(file) {\r\n    if ($(\"#book-medium\")[0].value == \"av\") return true;\r\n    var barcodeValue = parseInt($(\"#barcode\").html());\r\n    if (isNaN(barcodeValue) || barcodeValue.toString().substring(0, 5) != \"11711\") {\r\n        alert(\"There was a problem saving that image.\");\r\n        return false;\r\n    }\r\n    var bookSpecificRef = firebase.storage().ref().child(\"books\");\r\n    var meta;\r\n    if (file.type == \"image/jpg\" || file.type == \"image/jpeg\") {\r\n        bookSpecificRef = bookSpecificRef.child(barcodeValue + \"/cover.jpg\");\r\n        meta = {contentType: 'image/jpeg'};\r\n    } else if (file.type == \"image/png\") {\r\n        bookSpecificRef = bookSpecificRef.child(barcodeValue + \"/cover.png\");\r\n        meta = {contentType: 'image/png'};\r\n    } else {\r\n        alert(\"That file type is not supported. Please upload a JPG or PNG file.\");\r\n        return false;\r\n    }\r\n    return bookSpecificRef.put(file, meta).then(() => {\r\n        console.log('Uploaded the file!');\r\n        return bookSpecificRef.getDownloadURL().then((url) => {\r\n            $('#book-cover-image').attr('src', url);\r\n            return url;\r\n        }).catch(function(error) {\r\n            alert(\"ERROR: There was a problem storing the book cover image. Your book information has not been saved.\");\r\n            console.error(error);\r\n        });\r\n    });\r\n}\r\n\r\nvar file;\r\n\r\nvar loadFile = function(event) {\r\n    if (event.target.files[0]) {\r\n        file = event.target.files[0];\r\n        var output = document.getElementById('book-cover-image');\r\n        output.src = URL.createObjectURL(file);\r\n        output.onload = function() {\r\n            URL.revokeObjectURL(output.src); // free memory\r\n        };\r\n    }\r\n};\r\n/* No Longer needed (I think)\r\nfunction uploadCoverImageFromExternal(link) {\r\n    var ref = firebase.storage().ref();\r\n    ref = ref.child(barcodeNumber  + \"/cover.jpg\");\r\n\r\n    ref.put(link, {contentType: 'image/jpeg'}).then((snapshot) => {\r\n        console.log(\"Image has been uploaded from the external source.\");\r\n    });\r\n}*/\r\n\r\nvar loadingTimer;\r\nfunction validateEntry() {\r\n    return new Promise((resolve) => {\r\n        // Gets the values of all the input elements\r\n        var titleValue = $(\"#book-title\").val();\r\n        var author1LastValue = $(\"#book-author-1-last\").val();\r\n        var author1FirstValue = $(\"#book-author-1-first\").val();\r\n        var mediumValue = $(\"#book-medium\")[0].value;\r\n        var coverLink = $(\"#book-cover-image\").attr('src');\r\n        var subjectValues = [];\r\n        var maxSubject = false;\r\n        for (let i = 1; !maxSubject; i++) {\r\n            if ($(\"#book-subject-\" + i)[0]) {\r\n                if ($(\"#book-subject-\" + i).val() != \"\") {\r\n                    subjectValues.push($(\"#book-subject-\" + i).val());\r\n                } else {\r\n                    maxSubject = true;\r\n                }\r\n            } else {\r\n                maxSubject = true;\r\n            }\r\n        }\r\n        var descriptionValue = $(\"#book-description\").val();\r\n        var childrenValue = $(\"#book-audience-children\")[0].checked;\r\n        var youthValue = $(\"#book-audience-youth\")[0].checked;\r\n        var adultValue = $(\"#book-audience-adult\")[0].checked;\r\n        var noneValue = $(\"#book-audience-none\")[0].checked;\r\n        var isbn10Value = $(\"#book-isbn-10\").val();\r\n        var isbn13Value = $(\"#book-isbn-13\").val();\r\n        var noISBN = $(\"#book-no-isbn\")[0].checked;\r\n        var publisher1Value = $(\"#book-publisher-1\").val();\r\n        var publishMonthValue = $(\"#book-publish-month\").val();\r\n        var publishDayValue = $(\"#book-publish-day\").val();\r\n        var publishYearValue = $(\"#book-publish-year\").val();\r\n        var numPagesValue = parseInt($(\"#book-pages\").val());\r\n        var unNumbered = $(\"#book-unnumbered\")[0].checked;\r\n        var ddcValue = $(\"#book-dewey\").val();\r\n        var purchaseMonthValue = $(\"#book-purchase-month\").val();\r\n        var purchaseDayValue = $(\"#book-purchase-day\").val();\r\n        var purchaseYearValue = $(\"#book-purchase-year\").val();\r\n        var purchasePriceValue = $(\"#book-purchase-price\").val();\r\n        \r\n        // Validate inputs\r\n        if (titleValue == \"\") {\r\n            alert(\"Title is required!\");\r\n            let rect = $(\"#book-title\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-title\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-title\")[0].focus();}, 600);\r\n            $(\"#book-title\")[0].onkeydown = function() {\r\n                $(\"#book-title\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (author1LastValue == \"\" && author1FirstValue == \"\" && mediumValue != \"av\") {\r\n            alert(\"At least one author is required! If author is unknown, enter \\\"unknown\\\" into last name.\");\r\n            let rect = $(\"#book-author-1-last\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-author-1-last\")[0].style.borderColor = \"red\";\r\n            $(\"#book-author-1-first\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-author-1-last\")[0].focus();}, 600);\r\n            $(\"#book-author-1-last\")[0].onkeydown = function() {\r\n                $(\"#book-author-1-last\")[0].style.borderColor = \"\";\r\n                $(\"#book-author-1-first\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-author-1-first\")[0].onkeydown = function() {\r\n                $(\"#book-author-1-last\")[0].style.borderColor = \"\";\r\n                $(\"#book-author-1-first\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (mediumValue == \"\") {\r\n            alert(\"Medium is required!\");\r\n            let rect = $(\"#book-medium\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-medium\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-medium\")[0].focus();}, 600);\r\n            $(\"#book-medium\")[0].onclick = function() {\r\n                $(\"#book-medium\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (coverLink == \"../img/favicon.ico\" && mediumValue != \"av\") {\r\n            alert(\"Cover image is required!\");\r\n            let rect = $(\"#book-cover-image\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-cover-image\")[0].style.boxShadow = \"0px 0px 16px 0px #ff00008a\";\r\n            setTimeout(function() {$(\"#book-cover-image\")[0].focus();}, 600);\r\n            $(\"#book-cover-image\")[0].onkeydown = function() {\r\n                $(\"#book-cover-image\")[0].style.boxShadow = \"0px 0px 16px 0px #aaaaaa4a\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (subjectValues[0] == \"\" && mediumValue != \"av\") {\r\n            alert(\"Please enter at least one subject!\");\r\n            let rect = $(\"#book-subject-1\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-subject-1\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-subject-1\")[0].focus();}, 600);\r\n            $(\"#book-subject-1\")[0].onkeydown = function() {\r\n                $(\"#book-subject-1\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (descriptionValue == \"\" && mediumValue != \"av\") {\r\n            alert(\"Description is required!\");\r\n            let rect = $(\"#book-description\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-description\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-description\")[0].focus();}, 600);\r\n            $(\"#book-description\")[0].onkeydown = function() {\r\n                $(\"#book-description\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if ((!childrenValue && !youthValue && !adultValue && !noneValue) || (noneValue && (childrenValue || youthValue || adultValue))) {\r\n            alert(\"Invalid audience input! If there is no audience listed, please select \\\"None\\\" (and no other checkboxes).\");\r\n            let rect = $(\"#book-audience-children\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-audience-children\")[0].style.outline = \"2px solid red\";\r\n            $(\"#book-audience-youth\")[0].style.outline = \"2px solid red\";\r\n            $(\"#book-audience-adult\")[0].style.outline = \"2px solid red\";\r\n            $(\"#book-audience-none\")[0].style.outline = \"2px solid red\";\r\n            setTimeout(function() {$(\"#book-audience-children\")[0].focus();}, 600);\r\n            $(\"#book-audience-children\")[0].onkeydown = function() {\r\n                $(\"#book-audience-children\")[0].style.outline = \"\";\r\n                $(\"#book-audience-youth\")[0].style.outline = \"\";\r\n                $(\"#book-audience-adult\")[0].style.outline = \"\";\r\n                $(\"#book-audience-none\")[0].style.outline = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (mediumValue != \"av\" && !noISBN && isbn10Value == \"\" && isbn13Value == \"\") {\r\n            alert(\"Please enter at least one ISBN number!\");\r\n            let rect = $(\"#book-isbn-10\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-isbn-10\")[0].style.borderColor = \"red\";\r\n            $(\"#book-isbn-13\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-isbn-10\")[0].focus();}, 600);\r\n            $(\"#book-isbn-10\")[0].onkeydown = function() {\r\n                $(\"#book-isbn-10\")[0].style.borderColor = \"\";\r\n                $(\"#book-isbn-13\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-isbn-13\")[0].onkeydown = function() {\r\n                $(\"#book-isbn-10\")[0].style.borderColor = \"\";\r\n                $(\"#book-isbn-13\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (!noISBN && !verifyISBN(isbn10Value) && isbn10Value != \"\" && mediumValue != \"av\") {\r\n            alert(\"The ISBN number you entered was not valid! Please double check it.\");\r\n            let rect = $(\"#book-isbn-10\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-isbn-10\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-isbn-10\")[0].focus();}, 600);\r\n            $(\"#book-isbn-10\")[0].onkeydown = function() {\r\n                $(\"#book-isbn-10\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (!noISBN && !verifyISBN(isbn13Value) && isbn13Value != \"\" && mediumValue != \"av\") {\r\n            alert(\"The ISBN number you entered was not valid! Please double check it.\");\r\n            let rect = $(\"#book-isbn-13\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-isbn-13\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-isbn-13\")[0].focus();}, 600);\r\n            $(\"#book-isbn-13\")[0].onkeydown = function() {\r\n                $(\"#book-isbn-13\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (publisher1Value == \"\" && mediumValue != \"av\") {\r\n            alert(\"Please enter at least one publisher! If the publisher is unknown, enter \\\"unknown\\\".\");\r\n            let rect = $(\"#book-publisher-1\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-publisher-1\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-publisher-1\")[0].focus();}, 600);\r\n            $(\"#book-publisher-1\")[0].onkeydown = function() {\r\n                $(\"#book-publisher-1\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (!isValidDate(publishMonthValue, publishDayValue, publishYearValue) && mediumValue != \"av\") {\r\n            alert(\"The publishing date is invalid! Please enter a valid date between October 17, 1711 and today.\");\r\n            let rect = $(\"#book-publish-month\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-publish-month\")[0].style.borderColor = \"red\";\r\n            $(\"#book-publish-day\")[0].style.borderColor = \"red\";\r\n            $(\"#book-publish-year\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-publish-month\")[0].focus();}, 600);\r\n            $(\"#book-publish-month\")[0].onkeydown = function() {\r\n                $(\"#book-publish-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-year\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-publish-day\")[0].onkeydown = function() {\r\n                $(\"#book-publish-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-year\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-publish-year\")[0].onkeydown = function() {\r\n                $(\"#book-publish-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-publish-year\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (!unNumbered && (numPagesValue == \"\" || isNaN(parseInt(numPagesValue) || parseInt(numPagesValue) < 1)) && mediumValue != \"av\") {\r\n            alert(\"Please enter a valid number of pages!\");\r\n            let rect = $(\"#book-pages\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-pages\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-pages\")[0].focus();}, 600);\r\n            $(\"#book-pages\")[0].onkeydown = function() {\r\n                $(\"#book-pages\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (ddcValue == \"\" || (ddcValue != \"FIC\" && isNaN(parseFloat(ddcValue)))) {\r\n            alert(\"Please enter a valid Dewey Decimal Classification!\");\r\n            let rect = $(\"#book-dewey\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-dewey\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-dewey\")[0].focus();}, 600);\r\n            $(\"#book-dewey\")[0].onkeydown = function() {\r\n                $(\"#book-dewey\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if ((purchaseMonthValue != \"\" || purchaseDayValue != \"\" || purchaseYearValue != \"\") && !isValidDate(purchaseMonthValue, purchaseDayValue, purchaseYearValue)) {\r\n            alert(\"The purchasing date is invalid! Please enter a valid date between October 17, 1711 and today.\");\r\n            let rect = $(\"#book-purchase-month\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-purchase-month\")[0].style.borderColor = \"red\";\r\n            $(\"#book-purchase-day\")[0].style.borderColor = \"red\";\r\n            $(\"#book-purchase-year\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-purchase-month\")[0].focus();}, 600);\r\n            $(\"#book-purchase-month\")[0].onkeydown = function() {\r\n                $(\"#book-purchase-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-year\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-purchase-day\")[0].onkeydown = function() {\r\n                $(\"#book-purchase-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-year\")[0].style.borderColor = \"\";\r\n            };\r\n            $(\"#book-purchase-year\")[0].onkeydown = function() {\r\n                $(\"#book-purchase-month\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-day\")[0].style.borderColor = \"\";\r\n                $(\"#book-purchase-year\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n        if (purchasePriceValue != \"\" && (isNaN(parseFloat(purchasePriceValue)) || parseFloat(purchasePriceValue) < 0)) {\r\n            alert(\"Please enter a valid purchase price!\");\r\n            let rect = $(\"#book-purchase-price\")[0].getBoundingClientRect();\r\n            window.scrollBy(0, rect.top - 180);\r\n            $(\"#book-purchase-price\")[0].style.borderColor = \"red\";\r\n            setTimeout(function() {$(\"#book-purchase-price\")[0].focus();}, 600);\r\n            $(\"#book-purchase-price\")[0].onkeydown = function() {\r\n                $(\"#book-purchase-price\")[0].style.borderColor = \"\";\r\n            };\r\n            resolve(false);\r\n            return;\r\n        }\r\n\r\n        \r\n        $(\"#edit-entry-save\")[0].disabled = true;\r\n        $(\"#loading-overlay\").show();\r\n        loadingTimer = window.setTimeout(() => {\r\n            $(\"#edit-entry-save\")[0].disabled = false;\r\n            alert(\"An error has likely occurred, but we couldn't identify the problem. Your changes have not been saved.\");\r\n            $(\"#loading-overlay\").hide();\r\n        }, 10000);\r\n\r\n        if (mediumValue != \"av\") {\r\n            let input = $(\"#file-input\")[0];\r\n            if (input.files.length > 0 || $(\"#book-cover-image\").attr(\"src\").indexOf(\"firebase\") < 0) {\r\n                // If there's an image to upload...\r\n                saveImage().then((res) => {\r\n                    createAndUploadThumbnail().then((thumbnailLink) => {\r\n                        resolve([res, thumbnailLink]);\r\n                    }).catch((error) => {\r\n                        alert(\"The Thumbnail Image could not be generated.\");\r\n                        console.error(error);\r\n                        resolve([res, undefined]);\r\n                    });\r\n                });\r\n            } else if ($(\"#book-cover-image\").attr(\"src\").indexOf(\"firebase\") >= 0 && (newEntry || editEntryData.thumbnailImageLink == null) && $(\"#book-cover-image\")[0].naturalHeight > 300) {\r\n                // If the link has firebase but doesn't have 300x300 we can assume that only one image exists\r\n                // and we need to upload the smaller version\r\n                createAndUploadThumbnail().then((thumbnailLink) => {\r\n                    resolve([undefined, thumbnailLink]);\r\n                }).catch((error) => {\r\n                    alert(\"The Thumbnail Image could not be generated.\");\r\n                    console.error(error);\r\n                    resolve([undefined, undefined]);\r\n                });\r\n            } else {\r\n                resolve(true);\r\n            }\r\n        } else {\r\n            resolve(true);\r\n        }\r\n    });\r\n}\r\n\r\nfunction createAndUploadThumbnail() {\r\n    return new Promise(function (resolve, reject) {\r\n        if ($(\"#book-medium\")[0].value == \"av\") resolve(true);\r\n        const canvas = document.createElement(\"canvas\");\r\n        canvas.id = \"thumbnail-canvas\";\r\n        $(\".book-cover-image-container\")[0].appendChild(canvas);\r\n        var height = $(\"#book-cover-image\").height();\r\n        var width = $(\"#book-cover-image\").width();\r\n        var ratio = height / width;\r\n        $(\"#thumbnail-canvas\")[0].height = 300;\r\n        $(\"#thumbnail-canvas\")[0].width = Math.round(300 / ratio);\r\n        var ctx = $(\"#thumbnail-canvas\")[0].getContext('2d');\r\n        var image = new Image($(\"#book-cover-image\")[0].naturalWidth, $(\"#book-cover-image\")[0].naturalHeight);\r\n        image.setAttribute(\"crossorigin\", \"anonymous\");\r\n        image.onload = () => {\r\n            ctx.drawImage(image, 0, 0, 300 / ratio, 300);\r\n            $(\"#thumbnail-canvas\")[0].toBlob((blob) => {\r\n                var file = new File([blob], \"thumbnail\", {type: blob.type});\r\n                var barcodeValue = parseInt($(\"#barcode\").html());\r\n                if (isNaN(barcodeValue) || barcodeValue.toString().substring(0, 5) != \"11711\") {\r\n                    alert(\"There was a problem saving that image.\");\r\n                    reject(false);\r\n                }\r\n                var bookSpecificRef = firebase.storage().ref().child(\"books\");\r\n                var meta;\r\n                if (file.type == \"image/jpg\" || file.type == \"image/jpeg\") {\r\n                    bookSpecificRef = bookSpecificRef.child(barcodeValue + \"/cover-300px.jpg\");\r\n                    meta = {contentType: 'image/jpeg'};\r\n                } else if (file.type == \"image/png\") {\r\n                    bookSpecificRef = bookSpecificRef.child(barcodeValue + \"/cover-300px.png\");\r\n                    meta = {contentType: 'image/png'};\r\n                } else {\r\n                    alert(\"That file type is not supported. Please upload a JPG or PNG file.\");\r\n                    reject(false);\r\n                }\r\n                bookSpecificRef.put(file, meta).then(() => {\r\n                    console.log('Uploaded the file!');\r\n                    bookSpecificRef.getDownloadURL().then((url) => {\r\n                        resolve(url);\r\n                    }).catch(function(error) {\r\n                        alert(\"ERROR: There was a problem storing the book cover image. Your book information has not been saved.\");\r\n                        console.error(error);\r\n                    });\r\n                });\r\n            }, \"image/jpeg\");\r\n        };\r\n        image.src = $(\"#book-cover-image\")[0].src;\r\n    });\r\n}\r\n\r\nfunction isValidDate(m, d, y) {\r\n    var year = parseInt(y);\r\n    if (isNaN(year)) return false;\r\n    if (year < 100) return false;\r\n    var month = parseInt(m) - 1;\r\n    if (isNaN(month) && m != \"\") return false;\r\n    var day = parseInt(d);\r\n    if (isNaN(day) && d != \"\") return false;\r\n    if (m == \"\" && d != \"\") return false;\r\n    if ((month > 11 || month < 0) && m != \"\") return false;\r\n    if ((day > 31 || day < 1) && d != \"\") return false;\r\n    if (day == 31 & (month == 3 || month == 5 || month == 8 || month == 10)) return false;\r\n    if (month == 1 && day > 29) return false;\r\n    if ((year % 4 != 0 || (year % 100 == 0 && year % 400 != 0)) && month == 1 && day == 29) return false;\r\n    var date = new Date(year, month, day);\r\n    if (date.getTime() > Date.now()) return false;\r\n    var founded = new Date(1711, 9, 17);\r\n    if (date.getTime() < founded.getTime()) return false;\r\n    return true;\r\n}\r\n\r\nfunction editEntry(barcodeValue = null, isDeletedValue = false) {\r\n    // Gets the values of all the input elements\r\n    if (barcodeValue == null) {\r\n        barcodeValue = parseInt($(\"#barcode\").html());\r\n    }\r\n    var titleValue = $(\"#book-title\").val();\r\n    var subtitleValue = $(\"#book-subtitle\").val();\r\n    var author1LastValue = $(\"#book-author-1-last\").val();\r\n    var author1FirstValue = $(\"#book-author-1-first\").val();\r\n    var author2LastValue = $(\"#book-author-2-last\").val();\r\n    var author2FirstValue = $(\"#book-author-2-first\").val();\r\n    var illustrator1LastValue = $(\"#book-illustrator-1-last\").val();\r\n    var illustrator1FirstValue = $(\"#book-illustrator-1-first\").val();\r\n    var illustrator2LastValue = $(\"#book-illustrator-2-last\").val();\r\n    var illustrator2FirstValue = $(\"#book-illustrator-2-first\").val();\r\n    var mediumValue = $(\"#book-medium\")[0].value;\r\n    var coverLink = $(\"#book-cover-image\").attr('src');\r\n    var subjectValues = [];\r\n    var maxSubject = false;\r\n    for (let i = 1; !maxSubject; i++) {\r\n        if ($(\"#book-subject-\" + i)[0]) {\r\n            if ($(\"#book-subject-\" + i).val() != \"\") {\r\n                subjectValues.push($(\"#book-subject-\" + i).val());\r\n            } else {\r\n                maxSubject = true;\r\n            }\r\n        } else {\r\n            maxSubject = true;\r\n        }\r\n    }\r\n    var descriptionValue = $(\"#book-description\").val();\r\n    var childrenValue = $(\"#book-audience-children\")[0].checked;\r\n    var youthValue = $(\"#book-audience-youth\")[0].checked;\r\n    var adultValue = $(\"#book-audience-adult\")[0].checked;\r\n    var noneValue = $(\"#book-audience-none\")[0].checked;\r\n    var isbn10Value = $(\"#book-isbn-10\").val();\r\n    var isbn13Value = $(\"#book-isbn-13\").val();\r\n    var noISBN = $(\"#book-no-isbn\")[0].checked;\r\n    var publisher1Value = $(\"#book-publisher-1\").val();\r\n    var publisher2Value = $(\"#book-publisher-2\").val();\r\n    var publishMonthValue = $(\"#book-publish-month\").val();\r\n    var publishDayValue = $(\"#book-publish-day\").val();\r\n    var publishYearValue = $(\"#book-publish-year\").val();\r\n    var numPagesValue = parseInt($(\"#book-pages\").val());\r\n    var unNumbered = $(\"#book-unnumbered\")[0].checked;\r\n    var ddcValue = $(\"#book-dewey\").val();\r\n    var canBeCheckedOutValue = !!$(\"#book-can-be-checked-out\")[0].value;\r\n    var isHiddenValue = !!$(\"#book-is-hidden\")[0].value;\r\n    var purchaseMonthValue = $(\"#book-purchase-month\").val();\r\n    var purchaseDayValue = $(\"#book-purchase-day\").val();\r\n    var purchaseYearValue = $(\"#book-purchase-year\").val();\r\n    var purchasePriceValue = $(\"#book-purchase-price\").val();\r\n    var vendorValue = $(\"#book-vendor\").val();\r\n\r\n    // Validate inputs (unless it's gonna be deleted, in which case don't bother lol)\r\n    var thumbnailLink = null;\r\n    validateEntry().then((valid) => {\r\n        if ((!isDeletedValue && valid == false) || valid == null) return;\r\n        if (valid != true) {\r\n            // There is information to be stored.\r\n            if (Array.isArray(valid)) {\r\n                if (valid.length == 1 && valid[0] != undefined) {\r\n                    coverLink = valid[0];\r\n                } else if (valid.length == 2) {\r\n                    if (valid[0] != undefined) {\r\n                        coverLink = valid[0];\r\n                    }\r\n                    if (valid[1] != undefined) {\r\n                        thumbnailLink = valid[1];\r\n                    }\r\n                }\r\n            } else {\r\n                coverLink = valid;\r\n            }\r\n        }\r\n\r\n        // Defines the paths of the the database collection\r\n        var booksPath = db.collection(\"books\");\r\n    \r\n        // Create a list of keywords from the description\r\n        var keywordsValue = descriptionValue.replace(/-/g , \" \").split(\" \");\r\n    \r\n        keywordsValue = cleanUpSearchTerm(keywordsValue);\r\n    \r\n        var bookNumber = barcodeValue - 1171100000;\r\n        var bookDocument = Math.floor(bookNumber / 100);\r\n        if (bookDocument >= 100) {\r\n            bookDocument = \"\" + bookDocument;\r\n        } else if (bookDocument >= 10) {\r\n            bookDocument = \"0\" + bookDocument;\r\n        } else {\r\n            bookDocument = \"00\" + bookDocument;\r\n        }\r\n        bookNumber = bookNumber % 100;\r\n    \r\n        var authorsValue = [{last: author1LastValue, first: author1FirstValue}];\r\n        if (author2FirstValue != \"\" || author2LastValue != \"\") {\r\n            authorsValue.push({last: author2LastValue, first: author2FirstValue});\r\n        }\r\n    \r\n        var illustratorsValue = [];\r\n        if (illustrator1FirstValue != \"\" || illustrator1LastValue != \"\") {\r\n            illustratorsValue.push({last: illustrator1LastValue, first: illustrator1FirstValue});\r\n        }\r\n        if (illustrator2FirstValue != \"\" || illustrator2LastValue != \"\") {\r\n            illustratorsValue.push({last: illustrator2LastValue, first: illustrator2FirstValue});\r\n        }\r\n    \r\n        var publishersValue = [];\r\n        if (publisher1Value != \"\") {\r\n            publishersValue.push(publisher1Value);\r\n        }\r\n        if (publisher2Value != \"\") {\r\n            publishersValue.push(publisher2Value);\r\n        }\r\n    \r\n        if (noISBN) {\r\n            isbn10Value = \"\";\r\n            isbn13Value = \"\";\r\n        }\r\n    \r\n        if (unNumbered) {\r\n            numPagesValue = -1;\r\n        }\r\n    \r\n        var publishDateValue = null;\r\n        if (publishMonthValue != \"\" && publishDayValue != \"\") {\r\n            publishDateValue = new Date(publishYearValue, publishMonthValue-1, publishDayValue);\r\n        } else if (publishMonthValue != \"\") {\r\n            publishDateValue = new Date(publishYearValue, publishMonthValue-1);\r\n        } else if (publishYearValue != \"\") {\r\n            publishDateValue = new Date(publishYearValue);\r\n        }\r\n        if (publishDateValue) {\r\n            publishDateValue = convertToUTC(publishDateValue);\r\n        }\r\n    \r\n        var purchaseDateValue = null;\r\n        if (purchaseMonthValue != \"\" && purchaseDayValue != \"\") {\r\n            purchaseDateValue = new Date(purchaseYearValue, purchaseMonthValue-1, purchaseDayValue);\r\n        } else if (purchaseMonthValue != \"\") {\r\n            purchaseDateValue = new Date(purchaseYearValue, purchaseMonthValue-1);\r\n        } else if (purchaseYearValue != \"\") {\r\n            purchaseDateValue = new Date(purchaseYearValue);\r\n        }\r\n        if (purchaseDateValue) {\r\n            purchaseDateValue = convertToUTC(purchaseDateValue);\r\n        }\r\n    \r\n        var lastUpdatedValue = new Date();\r\n    \r\n        // Updates the book with the information\r\n        db.runTransaction((transaction) => {\r\n            let path = booksPath.doc(bookDocument);\r\n            return transaction.get(path).then((doc) => {\r\n                if (!doc.exists) {\r\n                    console.error(\"There was a large problem because the books doc doesn't exist anymore...\");\r\n                }\r\n                var existingBooks = doc.data().books;\r\n                existingBooks[bookNumber] = {\r\n                    barcodeNumber: barcodeValue,\r\n                    title: titleValue,\r\n                    subtitle: subtitleValue,\r\n                    authors: authorsValue,\r\n                    illustrators: illustratorsValue,\r\n                    medium: mediumValue,\r\n                    coverImageLink: coverLink,\r\n                    thumbnailImageLink: thumbnailLink,\r\n                    subjects: subjectValues,\r\n                    description: descriptionValue,\r\n                    audience: [childrenValue, youthValue, adultValue, noneValue],\r\n                    isbn10: isbn10Value,\r\n                    isbn13: isbn13Value,\r\n                    publishers: publishersValue,\r\n                    publishDate: publishDateValue,\r\n                    numberOfPages: numPagesValue,\r\n                    ddc: ddcValue,\r\n                    purchaseDate: purchaseDateValue,\r\n                    purchasePrice: purchasePriceValue,\r\n                    vendor: vendorValue,\r\n                    keywords: keywordsValue,\r\n                    canBeCheckedOut: canBeCheckedOutValue,\r\n                    isDeleted: isDeletedValue,\r\n                    isHidden: isHiddenValue,\r\n                    lastUpdated: lastUpdatedValue\r\n                };\r\n                transaction.update(booksPath.doc(bookDocument), {\r\n                    books: existingBooks\r\n                });\r\n            });\r\n        }).then(() => {\r\n            $(\"#loading-overlay\").hide();\r\n            alert(\"Edits were made successfully\");\r\n            clearTimeout(loadingTimer);\r\n            $(window).off(\"beforeunload\");\r\n            goToPage('admin/main');\r\n        }).catch((err) => {\r\n            console.log(err);\r\n            alert(\"Your edits could not be saved. An error has occurred.\");\r\n        });\r\n    });\r\n}\r\n\r\nfunction cancelEditEntry() {\r\n    $(window).off(\"beforeunload\");\r\n\r\n    window.history.back();\r\n}\r\n\r\nfunction deleteEntry() {\r\n    $(\"#delete-alert\").css(\"transition\", \"0.5s\");\r\n    $(\"#delete-alert-overlay\").css(\"transition\", \"0.5s\");\r\n    if ($(\"#delete-alert\").css(\"opacity\") == \"0\") {\r\n        $(\"#delete-alert\").show();\r\n        $(\"#delete-alert-overlay\").show();\r\n        $(\"#delete-alert\").css(\"opacity\", \"100%\");\r\n        $(\"#delete-alert-overlay\").css(\"opacity\", \"50%\");\r\n    } else {\r\n        $(\"#delete-alert\").css(\"opacity\", \"0\");\r\n        $(\"#delete-alert-overlay\").css(\"opacity\", \"0\");\r\n        $(\"#delete-alert\").delay(500).hide(0);\r\n        $(\"#delete-alert-overlay\").delay(500).hide(0);\r\n    }\r\n}\r\n\r\n\r\nfunction cleanUpSearchTerm(searchArray) {\r\n    // List of words to remove from the keywords list\r\n    // eslint-disable-next-line max-len\r\n    var meaninglessWords = [\"the\", \"is\", \"it\", \"an\", \"to\", \"on\", \"a\", \"in\", \"than\", \"and\", \"as\", \"they'll\", \"also\", \"for\", \"more\", \"here\", \"with\", \"without\", \"within\", \"most\", \"about\", \"almost\", \"any\", \"at\", \"be\", \"but\", \"by\", \"can\", \"come\", \"could\", \"do\", \"else\", \"if\", \"few\", \"get\", \"go\", \"he\", \"she\", \"they\", \"them\", \"him\", \"her\", \"his\", \"hers\", \"theirs\", \"there\", \"i\", \"\", \"into\", \"it\", \"its\", \"itself\", \"let\", \"lots\", \"me\", \"much\", \"must\", \"my\", \"oh\", \"yes\", \"no\", \"none\", \"nor\", \"not\", \"now\", \"of\", \"ok\", \"or\", \"our\", \"out\", \"own\", \"per\", \"put\", \"say\", \"see\", \"set\", \"so\", \"some\", \"soon\", \"still\", \"stay\", \"such\", \"sure\", \"tell\", \"then\", \"that\", \"these\", \"thing\", \"this\", \"those\", \"too\", \"try\", \"us\", \"use\", \"we\", \"what\", \"where\", \"when\", \"why\", \"how\", \"who\", \"whom\", \"you\", \"your\"];\r\n    // Itterate through each word\r\n    for (let i = 0; i < searchArray.length; i++) {\r\n        // Remove all punctuation and make it lowercase\r\n        searchArray[i] = searchArray[i].replace(/-/g , \" \");\r\n        searchArray[i] = searchArray[i].replace(/[.,/#!$%^&*;:{}=\\-_`~()]/g,\"\");\r\n        searchArray[i] = searchArray[i].toLowerCase();\r\n        // Remove it from the list if it's meaningless\r\n        if (meaninglessWords.includes(searchArray[i])) {\r\n            searchArray.splice(i, 1);\r\n            i--;\r\n        }\r\n    }\r\n    return searchArray;\r\n}\r\n\r\n\r\nfunction convertToUTC(date) {\r\n    // TODO: Acutally account for time shifts with Daylight Savings\r\n    console.log(\"The date that was just saved was: \" + new Date(date.valueOf() + 1000 * 60 * 60 * 5));\r\n    return new Date(date.valueOf() + 1000 * 60 * 60 * 5);\r\n}\r\n\r\n// Returns true if there are unsaved changes on the Edit Entry page\r\nexport function unSavedChangesEditEntry() {\r\n    // TODO: Fix\r\n\r\n    return false;\r\n}\r\n"],"names":[],"sourceRoot":""}